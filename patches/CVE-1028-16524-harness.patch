From 39c2e171eb48e907473d9f0057ca6e17b2573399 Mon Sep 17 00:00:00 2001
From: Paschal Amusuo <amusuopaschal@gmail.com>
Date: Wed, 16 Oct 2024 18:49:48 -0400
Subject: [PATCH] Changes to recreate and expose CVEs

---
 .../cbmc/proofs/CheckOptions/CheckOptions_harness.c | 13 +++----------
 1 file changed, 3 insertions(+), 10 deletions(-)

diff --git a/test/cbmc/proofs/CheckOptions/CheckOptions_harness.c b/test/cbmc/proofs/CheckOptions/CheckOptions_harness.c
index 134d73c..c09bea3 100644
--- a/test/cbmc/proofs/CheckOptions/CheckOptions_harness.c
+++ b/test/cbmc/proofs/CheckOptions/CheckOptions_harness.c
@@ -51,6 +51,9 @@ int32_t __CPROVER_file_local_FreeRTOS_TCP_Reception_c_prvSingleStepTCPHeaderOpti
                                                                                      FreeRTOS_Socket_t * const pxSocket,
                                                                                      BaseType_t xHasSYNFlag )
 {
+    // ICSE-NIER: Added this constraint to expose CVE-2018-16524
+    __CPROVER_assert(__CPROVER_rw_ok(pucPtr, uxTotalLength), "p is readable and writable");
+
     /* CBMC model of pointers limits the size of the buffer */
 
     /* Preconditions */
@@ -73,16 +76,6 @@ int32_t __CPROVER_file_local_FreeRTOS_TCP_Reception_c_prvSingleStepTCPHeaderOpti
     return index;
 }
 
-size_t uxIPHeaderSizePacket( const NetworkBufferDescriptor_t * pxNetworkBuffer )
-{
-    __CPROVER_assert( pxNetworkBuffer != NULL, "pxNetworkBuffer should not be NULL" );
-    return uxIPHeaderSizePacket_uxResult;
-}
-
-/****************************************************************
-* Proof of CheckOptions
-****************************************************************/
-
 void harness()
 {
     /* Give buffer_size an unconstrained value */
-- 
2.25.1

