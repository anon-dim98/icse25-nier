From 39c2e171eb48e907473d9f0057ca6e17b2573399 Mon Sep 17 00:00:00 2001
From: Paschal Amusuo <amusuopaschal@gmail.com>
Date: Wed, 16 Oct 2024 18:49:48 -0400
Subject: [PATCH] Changes to recreate and expose CVEs

---
 source/FreeRTOS_ICMP.c | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/source/FreeRTOS_ICMP.c b/source/FreeRTOS_ICMP.c
index 75e51bb..d518731 100644
--- a/source/FreeRTOS_ICMP.c
+++ b/source/FreeRTOS_ICMP.c
@@ -86,9 +86,11 @@
 
         iptraceICMP_PACKET_RECEIVED();
 
-        configASSERT( pxNetworkBuffer->xDataLength >= sizeof( ICMPPacket_t ) );
+        // ICSE-NIER: Commented out the following two checks to expose CVE-2018-16527
+        // configASSERT( pxNetworkBuffer->xDataLength >= sizeof( ICMPPacket_t ) );
 
-        if( pxNetworkBuffer->xDataLength >= sizeof( ICMPPacket_t ) )
+        // if( pxNetworkBuffer->xDataLength >= sizeof( ICMPPacket_t ) )
+        // if (pdTRUE)
         {
             /* Map the buffer onto a ICMP-Packet struct to easily access the
              * fields of ICMP packet. */
-- 
2.25.1

