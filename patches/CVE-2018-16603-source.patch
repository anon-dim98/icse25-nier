From 39c2e171eb48e907473d9f0057ca6e17b2573399 Mon Sep 17 00:00:00 2001
From: Paschal Amusuo <amusuopaschal@gmail.com>
Date: Wed, 16 Oct 2024 18:49:48 -0400
Subject: [PATCH] Changes to recreate and expose CVEs

---
 source/FreeRTOS_TCP_IP.c | 2 ++
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/source/FreeRTOS_TCP_IP.c b/source/FreeRTOS_TCP_IP.c
index cfba8d0..c366191 100644
--- a/source/FreeRTOS_TCP_IP.c
+++ b/source/FreeRTOS_TCP_IP.c
@@ -703,7 +703,9 @@
         uxIPHeaderOffset = ipSIZE_OF_ETH_HEADER + uxIPHeaderSizePacket( pxNetworkBuffer );
 
         /* Check for a minimum packet size. */
+        // ICSE-NIER: Commented out the validation to expose CVE-2018-16603
+        // if( pxNetworkBuffer->xDataLength < ( uxIPHeaderOffset + ipSIZE_OF_TCP_HEADER ) )
-	 if( pxNetworkBuffer->xDataLength < ( uxIPHeaderOffset + ipSIZE_OF_TCP_HEADER ) )
+        // if (pdFALSE)
         {
             xResult = pdFAIL;
         }
-- 
2.25.1

